INFO:     Started server process [1]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     14.150.194.199:10623 - "POST /webhook/trigger_video_process HTTP/1.1" 200 OK
Starting background processing for row: c7bcab53-936d-45f9-9159-9f3577c238fa

[Pipeline] Starting pipeline for Task ROW_ID: c7bcab53-936d-45f9-9159-9f3577c238fa
[Pipeline] 1/7: Fetching and downloading video...
[Pipeline] 2/7: Extracting audio...
[Pipeline] 3/7: Running ASR recognition...
[DashscopeService] Transcribing /app/tmp_workspace/c7bcab53-936d-45f9-9159-9f3577c238fa/original_audio.wav via NLS SDK ...
[NLS ASR] Starting stream (pcm)...
[NLS ASR] Sentence Begin: {"header":{"namespace":"SpeechTranscriber","name":"SentenceBegin","status":20000000,"message_id":"40367ce19fc44d8e8e866888dadfe684","task_id":"d80d79d8c3c94e27861039de28bb88af","status_text":"Gateway:SUCCESS:Success."},"payload":{"index":1,"time":0}}
[NLS ASR] Sentence End: {"header":{"namespace":"SpeechTranscriber","name":"SentenceEnd","status":20000000,"message_id":"c10da3ad5b314ba587d6b8b33a48fe90","task_id":"d80d79d8c3c94e27861039de28bb88af","status_text":"Gateway:SUCCESS:Success."},"payload":{"index":1,"time":56640,"result":"如何在电脑端查看一些呃生产异常的数据？呃，上方有四个模块，生产报检异常上报项目计划和操作手册。嗯，生产报警这边有报检记录和检验工单，在报警记录这边我们可以看到上方有这么多的视图，呃，分别是pcb功率、装配、调试、入库五个车间的未关闭的一些报警记录都会在这里可以查阅到。然后未关闭和已关闭的话是呃前面五个车间所有的呃未关闭的在这里展示，已关闭的在这里展示，全部的话是未关闭和已关闭的，都可以在这里查看。然后检验工单这边是可以看到我的一些未检验工单，然后整体所有的未关闭工单，然后已关闭工单和呃未关闭已关闭的工单在全部这里展示，然后在异常上报这边的话也是异常问题。这边可以看到一个未关闭的异常问题，已关闭的异常问题和全部异常问题。","confidence":0.874,"words":[],"status":0,"gender":"","begin_time":0,"fixed_result":"","unfixed_result":"","stash_result":{"sentenceId":2,"beginTime":56640,"text":"","fixedText":"","unfixedText":"","currentTime":56640,"words":[]},"audio_extra_info":"","sentence_id":"4854824aafaf499c97e2e496720e7931","gender_score":0.0}}
[NLS ASR] Sentence Begin: {"header":{"namespace":"SpeechTranscriber","name":"SentenceBegin","status":20000000,"message_id":"cb9ebd66d8024e82a6f9f089eff3c31c","task_id":"d80d79d8c3c94e27861039de28bb88af","status_text":"Gateway:SUCCESS:Success."},"payload":{"index":2,"time":58100}}
[NLS ASR] Sentence End: {"header":{"namespace":"SpeechTranscriber","name":"SentenceEnd","status":20000000,"message_id":"f8eb771ff2c94699a8d3975f41016f24","task_id":"d80d79d8c3c94e27861039de28bb88af","status_text":"Gateway:SUCCESS:Success."},"payload":{"index":2,"time":80220,"result":"然后在管理仪表盘这边，我们可以看到呃有一个异常大类的统计占比。异常子类的统计占比，还有一个异常统计的趋势图可以查阅。然后在下方还做了一个未关闭的异常问题汇总。因为现在没有未关闭的异常问题，所以这边没有数据。然后在这里的话是汇总了一个所有的异常问题，我们可以点击放大进行查看。","confidence":0.871,"words":[],"status":0,"gender":"","begin_time":58100,"fixed_result":"","unfixed_result":"","stash_result":{"sentenceId":3,"beginTime":80220,"text":"","fixedText":"","unfixedText":"","currentTime":80220,"words":[]},"audio_extra_info":"","sentence_id":"a9e1d4364dd04a45b3ac5e866a14b37a","gender_score":0.0}}
[NLS ASR] Sentence Begin: {"header":{"namespace":"SpeechTranscriber","name":"SentenceBegin","status":20000000,"message_id":"6867fe9cbe0b44beb5cf20eeca106dff","task_id":"d80d79d8c3c94e27861039de28bb88af","status_text":"Gateway:SUCCESS:Success."},"payload":{"index":3,"time":80520}}
[NLS ASR] Sentence End: {"header":{"namespace":"SpeechTranscriber","name":"SentenceEnd","status":20000000,"message_id":"bc4a5291073f4b4ea8f68bce94f496aa","task_id":"d80d79d8c3c94e27861039de28bb88af","status_text":"Gateway:SUCCESS:Success."},"payload":{"index":3,"time":85880,"result":"然后如果我们想要下载的话，可以点击这边有有一个保存图片。","confidence":0.849,"words":[],"status":0,"gender":"","begin_time":80520,"fixed_result":"","unfixed_result":"","stash_result":{"sentenceId":4,"beginTime":85880,"text":"","fixedText":"","unfixedText":"","currentTime":85880,"words":[]},"audio_extra_info":"","sentence_id":"dec00a201c804a309fe346afe6f6db28","gender_score":0.0}}
[NLS ASR] Sentence Begin: {"header":{"namespace":"SpeechTranscriber","name":"SentenceBegin","status":20000000,"message_id":"b29f240217b342c99779d0ac6e8e036d","task_id":"d80d79d8c3c94e27861039de28bb88af","status_text":"Gateway:SUCCESS:Success."},"payload":{"index":4,"time":86420}}
[NLS ASR] Sentence End: {"header":{"namespace":"SpeechTranscriber","name":"SentenceEnd","status":20000000,"message_id":"4ce1458b3f9a4f388923ea925d2b9ad4","task_id":"d80d79d8c3c94e27861039de28bb88af","status_text":"Gateway:SUCCESS:Success."},"payload":{"index":4,"time":93720,"result":"然后在这边的话，也也可以把它导出excel，点击一下就可以生成excel了。","confidence":0.855,"words":[],"status":0,"gender":"","begin_time":86420,"fixed_result":"","unfixed_result":"","stash_result":{"sentenceId":5,"beginTime":93720,"text":"","fixedText":"","unfixedText":"","currentTime":93720,"words":[]},"audio_extra_info":"","sentence_id":"6677dbdf2b3e4b0fa4749d391ab8d9e2","gender_score":0.0}}
[NLS ASR] Sentence Begin: {"header":{"namespace":"SpeechTranscriber","name":"SentenceBegin","status":20000000,"message_id":"438c2a174706416097a871199213c666","task_id":"d80d79d8c3c94e27861039de28bb88af","status_text":"Gateway:SUCCESS:Success."},"payload":{"index":5,"time":95160}}
[NLS ASR] Sentence End: {"header":{"namespace":"SpeechTranscriber","name":"SentenceEnd","status":20000000,"message_id":"ccdd35e6313249f39c363c14124bced2","task_id":"d80d79d8c3c94e27861039de28bb88af","status_text":"Gateway:SUCCESS:Success."},"payload":{"index":5,"time":132040,"result":"然后在项目计划这边的话，如果我们的呃管理想要看，嗯，比如说项目0001号的这个项目的整体进度，其实我们可以看到现在两个出场编号都是在进行中的。然后因为目前这里的话是没有报检记录和异常问题的，以后如果有的话，都可以在在这里看到整个测试项目的报检记录和一个所发生的异常问题，都会关联在这里查看同样的出厂编号。也是的，这里有一个状态的展示，然后点进去之后可以看到一个报警记录和异常问题的一个整体的情况。","confidence":0.869,"words":[],"status":0,"gender":"","begin_time":95160,"fixed_result":"","unfixed_result":"","stash_result":{"sentenceId":6,"beginTime":132040,"text":"","fixedText":"","unfixedText":"","currentTime":132040,"words":[]},"audio_extra_info":"","sentence_id":"a2b9a9ed15454b2698068a7809c817ae","gender_score":0.0}}
[NLS ASR] Sentence Begin: {"header":{"namespace":"SpeechTranscriber","name":"SentenceBegin","status":20000000,"message_id":"d58f1d13f9d445aab478de2dc540b9ec","task_id":"d80d79d8c3c94e27861039de28bb88af","status_text":"Gateway:SUCCESS:Success."},"payload":{"index":6,"time":132180}}
[NLS ASR] Sentence End: {"header":{"namespace":"SpeechTranscriber","name":"SentenceEnd","status":20000000,"message_id":"b1871e02aa514755a8b9f01ef35486cd","task_id":"d80d79d8c3c94e27861039de28bb88af","status_text":"Gateway:SUCCESS:Success."},"payload":{"index":6,"time":153880,"result":"啊，然后操作手册这边的话就是我们呃就是培训新员工的时候，我们可以在这边点查找操作手册。然后生产人员看生产人员的检验人员，看检验人员的计划，人员看计计划人员的管理人员可以去看一下管理人员的视频。然后呃管理人员的呃介绍就大概到这里。","confidence":0.841,"words":[],"status":0,"gender":"","begin_time":132180,"fixed_result":"","unfixed_result":"","stash_result":{"sentenceId":7,"beginTime":153880,"text":"","fixedText":"","unfixedText":"","currentTime":153880,"words":[]},"audio_extra_info":"","sentence_id":"042189fedf6843bab7f3fa74a3965433","gender_score":0.0}}
[NLS ASR] Recognition completed: {"header":{"namespace":"SpeechTranscriber","name":"TranscriptionCompleted","status":20000000,"message_id":"d738a070d0634765ae413949718aa5a5","task_id":"d80d79d8c3c94e27861039de28bb88af","status_text":"Gateway:SUCCESS:Success."}}
[NLS ASR] Extracted 6 segments.[NLS ASR] Connection closed.

[Pipeline] 3.5/7: Auto-detecting industry context and correcting ASR typos via LLM...
[DashscopeService] Reading ASR text to auto-detect industry context...
[DashscopeService] Auto-detected context: manufacturing
[Pipeline] -> Detected video context: manufacturing
[DashscopeService] Correcting typos for 6 segments with context: manufacturing...
[DashscopeService]  -> Processing batch 1 (6 lines)...
[Pipeline] -> Uploading intermediate Mandarin Subtitle to Mingdao Cloud...
[HAP Repo] Uploading Mandarin Subtitles for c7bcab53-936d-45f9-9159-9f3577c238fa...
[Pipeline] 4/7: Processing 6 segments (Translate -> TTS -> Stretch)...
  -> Segment 1/6: 如何在电脑端查看一些呃生产异常的数据？呃，上方有四个模块，生产报检异常上报项目计划和操作手册。嗯，生产报警这边有报检记录和检验工单，在报警记录这边我们可以看到上方有这么多的视图，呃，分别是pcb功率、装配、调试、入库五个车间的未关闭的一些报警记录都会在这里可以查阅到。然后未关闭和已关闭的话是呃前面五个车间所有的呃未关闭的在这里展示，已关闭的在这里展示，全部的话是未关闭和已关闭的，都可以在这里查看。然后检验工单这边是可以看到我的一些未检验工单，然后整体所有的未关闭工单，然后已关闭工单和呃未关闭已关闭的工单在全部这里展示，然后在异常上报这边的话也是异常问题。这边可以看到一个未关闭的异常问题，已关闭的异常问题和全部异常问题。
[DashscopeService] Requesting NLS TTS with voice: Kelly...
[DashscopeService - NLS] completed: {"header":{"namespace":"SpeechSynthesizer","name":"SynthesisCompleted","status":20000000,"message_id":"4025a08cb7d443f1b809069f8a062fc3","task_id":"096f1eac091c4694a5ca1dba13778391","status_text":"Gateway:SUCCESS:Success."}}
[DashscopeService - NLS] connection closed
[MediaProcessor] Stretching /app/tmp_workspace/c7bcab53-936d-45f9-9159-9f3577c238fa/raw_tts_0.wav | Ratio: 1.122 (63540.688ms -> 56640ms)
  -> Segment 2/6: 然后在管理仪表盘这边，我们可以看到呃有一个异常大类的统计占比。异常子类的统计占比，还有一个异常统计的趋势图可以查阅。然后在下方还做了一个未关闭的异常问题汇总。因为现在没有未关闭的异常问题，所以这边没有数据。然后在这里的话是汇总了一个所有的异常问题，我们可以点击放大进行查看。
[DashscopeService] Requesting NLS TTS with voice: Kelly...
[DashscopeService - NLS] completed: {"header":{"namespace":"SpeechSynthesizer","name":"SynthesisCompleted","status":20000000,"message_id":"b6e2d2a8e2ad44ffa9f06c759c77722b","task_id":"3f3a9a4b04674784a3e424e109b0cbc8","status_text":"Gateway:SUCCESS:Success."}}
[DashscopeService - NLS] connection closed
[MediaProcessor] Stretching /app/tmp_workspace/c7bcab53-936d-45f9-9159-9f3577c238fa/raw_tts_1.wav | Ratio: 1.111 (24579.25ms -> 22120ms)
  -> Segment 3/6: 然后如果我们想要下载的话，可以点击这边有有一个保存图片。
[DashscopeService] Requesting NLS TTS with voice: Kelly...
[DashscopeService - NLS] completed: {"header":{"namespace":"SpeechSynthesizer","name":"SynthesisCompleted","status":20000000,"message_id":"fcb58821f3a54dae8cbb9515dcca9b18","task_id":"dbbdf6c778ff4d5786392e8e1269937e","status_text":"Gateway:SUCCESS:Success."}}
[DashscopeService - NLS] connection closed
[MediaProcessor] Stretching /app/tmp_workspace/c7bcab53-936d-45f9-9159-9f3577c238fa/raw_tts_2.wav | Ratio: 0.942 (5049.938ms -> 5360ms)
  -> Segment 4/6: 然后在这边的话，也也可以把它导出excel，点击一下就可以生成excel了。
[DashscopeService] Requesting NLS TTS with voice: Kelly...
[DashscopeService - NLS] completed: {"header":{"namespace":"SpeechSynthesizer","name":"SynthesisCompleted","status":20000000,"message_id":"fda7034811cc468d8bf91fb8736d4a8a","task_id":"16ecba9729374c5c819054993a31b3a6","status_text":"Gateway:SUCCESS:Success."}}
[DashscopeService - NLS] connection closed
[MediaProcessor] Stretching /app/tmp_workspace/c7bcab53-936d-45f9-9159-9f3577c238fa/raw_tts_3.wav | Ratio: 0.701 (5119.125ms -> 7300ms)
  -> Segment 5/6: 然后在项目计划这边的话，如果我们的呃管理想要看，嗯，比如说项目0001号的这个项目的整体进度，其实我们可以看到现在两个出场编号都是在进行中的。然后因为目前这里的话是没有报检记录和异常问题的，以后如果有的话，都可以在在这里看到整个测试项目的报检记录和一个所发生的异常问题，都会关联在这里查看同样的出厂编号。也是的，这里有一个状态的展示，然后点进去之后可以看到一个报警记录和异常问题的一个整体的情况。
[DashscopeService] Requesting NLS TTS with voice: Kelly...
[DashscopeService - NLS] completed: {"header":{"namespace":"SpeechSynthesizer","name":"SynthesisCompleted","status":20000000,"message_id":"0e3c77f170a54132bfe95b6c3905bfd3","task_id":"9014e98719c1483689e5ccd0170424f4","status_text":"Gateway:SUCCESS:Success."}}
[DashscopeService - NLS] connection closed
[MediaProcessor] Stretching /app/tmp_workspace/c7bcab53-936d-45f9-9159-9f3577c238fa/raw_tts_4.wav | Ratio: 0.989 (36463.0ms -> 36880ms)
  -> Segment 6/6: 啊，然后操作手册这边的话就是我们呃就是培训新员工的时候，我们可以在这边点查找操作手册。然后生产人员看生产人员的检验人员，看检验人员的计划，人员看计计划人员的管理人员可以去看一下管理人员的视频。然后呃管理人员的呃介绍就大概到这里。
[DashscopeService] Requesting NLS TTS with voice: Kelly...
[DashscopeService - NLS] completed: {"header":{"namespace":"SpeechSynthesizer","name":"SynthesisCompleted","status":20000000,"message_id":"9e86909972624bd48efb489d7c7ee1af","task_id":"051eef1c7cd8489bbc498622c47fdc76","status_text":"Gateway:SUCCESS:Success."}}
[DashscopeService - NLS] connection closed
[MediaProcessor] Stretching /app/tmp_workspace/c7bcab53-936d-45f9-9159-9f3577c238fa/raw_tts_5.wav | Ratio: 1.035 (22460.5ms -> 21700ms)
[Pipeline] 5/7: Merging audio and generating SRT...
[MediaProcessor] Merging 6 audio segments via pure Python `wave` module directly...
[Pipeline] -> Uploading intermediate Cantonese Subtitle and Audio to Mingdao Cloud...
[HAP Repo] Uploading Cantonese Subtitles for c7bcab53-936d-45f9-9159-9f3577c238fa...
[HAP Repo] Uploading Cantonese Audio for c7bcab53-936d-45f9-9159-9f3577c238fa...
[HAP Repo] URL Pull Strategy using http://219.151.179.8:9000/download/c7bcab53-936d-45f9-9159-9f3577c238fa/full_cantonese.wav
[HAP Repo] Mingdao rejected attachment full_cantonese.wav. API Response: {'error_msg': '数据不能为空', 'error_code': 10001, 'success': False}
[Pipeline] Warning: Failed to upload Cantonese Audio to Mingdao.
[Pipeline] 6/7: Remuxing video with hard-subs...
[MediaProcessor] Remuxing video with hard-subs. This may take a while depending on video length...
[Pipeline] 7/7: Uploading to HAP...
[HAP Repo] Mingdao rejected attachment translated_【管理】如何在电脑端查看生产异常处理数据？.mov. API Response: {'error_msg': '数据不能为空', 'error_code': 10001, 'success': False}
[HAP Repo] Successfully pushed error log to row c7bcab53-936d-45f9-9159-9f3577c238fa
[Pipeline] ERROR: 处理异常: 最终合成视频 【管理】如何在电脑端查看生产异常处理数据？.mov 成功，但上传至明道云失败 (API 拒绝或网络异常)！暂留本地文件未删除。
[HAP Repo] Successfully pushed error log to row c7bcab53-936d-45f9-9159-9f3577c238fa
